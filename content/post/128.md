---
title: webpack ã‚’ä½¿ã£ã¦ã¿ã¾ã—ãŸ
date: 2018-04-08T13:59:56+09:00
tags:
  - webpack
---

ä»¥å‰ã€ [CommonJS Modules ã‚’ä½¿ã£ãŸã¨ã]({{< relref "122.md" >}})ã« Browserify ã‚’ä½¿ã„ã¾ã—ãŸã€‚
æœ€è¿‘ã¯(ä»¥å‰ã‹ã‚‰)ã€ Browserify ã‚ˆã‚Šã‚‚ webpack ã®æ–¹ã‚’ã‚ˆãè¦‹ã‚‹ã®ã§ã€ webpack ã‚’ä½¿ã£ã¦ã¿ã¾ã—ãŸã€‚

<!--more-->

[Getting Started](https://webpack.js.org/guides/getting-started/) ã‚’å‚è€ƒã«é€²ã‚ã¦ã¿ã¾ã™ã€‚

## ç’°å¢ƒ

webpack 4.5.0

## webpack?

> Concepts
>
> At its core, webpack is a static module bundler for modern JavaScript applications.
>
> <cite>[Concepts](https://webpack.js.org/concepts/)</cite>

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ã‚ˆã†ã§ã™ã€‚

## Basic Setup

ä½œæ¥­ã™ã‚‹ãŸã‚ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ã§ã™ã€‚

```
$ mkdir webpack-demo && cd webpack-demo
```

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–ã™ã‚‹ã‚ˆã†ã§ã™ã€‚

```
$ npm init -y
Wrote to /path/to/webpack-demo/package.json:

{
  "name": "webpack-demo",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC"
}


```

webpack ã¨ webpack-cli ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‚ˆã†ã§ã™ã€‚

```
$ npm install webpack webpack-cli --save-dev
npm WARN deprecated nomnom@1.8.1: Package no longer supported. Contact support@npmjs.com for more info.
npm WARN deprecated babel-preset-es2015@6.24.1: ğŸ™Œ  Thanks for using Babel: we recommend using babel-preset-env now: please read babeljs.io/env to update!
npm notice created a lockfile as package-lock.json. You should commit this file.
npm WARN webpack-demo@1.0.0 No description
npm WARN webpack-demo@1.0.0 No repository field.
npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.1.3 (node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.1.3: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})

+ webpack@4.5.0
+ webpack-cli@2.0.14
added 751 packages from 417 contributors in 77.495s
```

Babel ã®è­¦å‘ŠãŒå‡ºã¦ã„ã¾ã™ãŒã€ webpack ã¯ Babel ã«ä¾å­˜ã—ã¦ã„ã‚‹ã¿ãŸã„ã§ã™ã€‚
babel-preset-es2015 ã®ãƒ—ãƒªã‚»ãƒƒãƒˆã˜ã‚ƒãªãã¦ã€ babel-preset-env ã®ãƒ—ãƒªã‚»ãƒƒãƒˆã‚’ä½¿ã†ã‚ˆã†ã«è¨€ã‚ã‚Œã¾ã—ãŸã€‚

index.html ã¨ index.js ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ã§ã™

project

```diff
  webpack-demo
  |- package.json
+ |- index.html
+ |- /src
+   |- index.js
```

src/index.js ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¬¡ã®é€šã‚Šä½œæˆã—ã¾ã—ãŸã€‚

```javascript
function component() {
  var element = document.createElement('div');

  // Lodash, currently included via a script, is required for this line to work
  element.innerHTML = _.join(['Hello', 'webpack'], ' ');

  return element;
}

document.body.appendChild(component());
```

Lodash ã¯ä½¿ã£ãŸã“ã¨ãªã„ã®ã§ã™ãŒã€ `join` ã—ã¦ HTML ã«è¨­å®šã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

index.html ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¬¡ã®é€šã‚Šä½œæˆã—ã¾ã—ãŸã€‚

```html
<!doctype html>
<html>
  <head>
    <title>Getting Started</title>
    <script src="https://unpkg.com/lodash@4.16.6"></script>
  </head>
  <body>
    <script src="./src/index.js"></script>
  </body>
</html>
```

Lodash ã‚’ `<script>` ã§èª­ã¿è¾¼ã‚€ã‚ˆã†ã§ã™ã€‚

package.json ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¬¡ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã—ãŸã€‚

```diff
  {
    "name": "webpack-demo",
    "version": "1.0.0",
    "description": "",
+   "private": true,
-   "main": "index.js",
    "scripts": {
      "test": "echo \"Error: no test specified\" && exit 1"
    },
    "keywords": [],
    "author": "",
    "license": "ISC",
    "devDependencies": {
      "webpack": "^4.0.1",
      "webpack-cli": "^2.0.9"
    },
    "dependencies": {}
  }
```

ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’èª¤ã£ã¦å…¬é–‹ã—ã¦ã—ã¾ã‚ãªã„ã‚ˆã†ã« private ã«ã—ã¦ã€ main ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã‚’å‰Šé™¤ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

ã“ã‚Œã§ã€ index.html ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‹ã‚‰é–‹ãã¾ã™ã€‚

ã™ã‚‹ã¨ã€ Hello webpack ã¨è¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚

ã¾ã ã€ã“ã“ã§ã¯ webpack ã§ãƒãƒ³ãƒ‰ãƒ«ã—ã¦ã„ãªã„çŠ¶æ…‹ã§ã™ã€‚
ã©ã‚“ãªçµæœã«ãªã‚‹ã‹æœ€åˆã«ç¢ºèªã—ã¦ã„ã‚‹ã®ã‹ãªã€‚
webpack ã§ãƒãƒ³ãƒ‰ãƒ«ã—ã¦ã‚‚åŒã˜çµæœã«ãªã‚‹ã ã‚ã†ã€ã¨ã€‚

## Creating a Bundle

index.html ã‚’ dsit/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã«ç§»å‹•ã™ã‚‹ã‚ˆã†ã§ã™ã€‚

project

```diff
  webpack-demo
  |- package.json
+ |- /dist
+   |- index.html
- |- index.html
  |- /src
    |- index.js
```

Lodash ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‚ˆã†ã§ã™ã€‚

```
$ npm install --save lodash
npm WARN webpack-demo@1.0.0 No description
npm WARN webpack-demo@1.0.0 No repository field.
npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.1.3 (node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.1.3: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})

+ lodash@4.17.5
updated 1 package in 18.089s
```

Lodash ã¯ `<script>` ã§èª­ã¿è¾¼ã‚€ã®ã§ã¯ãªãã€ npm ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚‚ã®ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹ã¿ãŸã„ã§ã™ã€‚

src/index.js ã‚’æ¬¡ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã—ãŸã€‚

```javascript
import _ from 'lodash';

function component() {
  var element = document.createElement('div');

  // Lodash, now imported by this script
  element.innerHTML = _.join(['Hello', 'webpack'], ' ');

  return element;
}

document.body.appendChild(component());
```

ECMAScript Modules ã® `import` ã‚’ä½¿ã£ã¦ Lodash ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸(ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)ã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã§ã™ã€‚
webpack ã¯ Babel ã«ä¾å­˜ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã—ãŸã®ã§ã€ ECMAScript Modules ã®è¨˜è¿°ã®ã¾ã¾ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã‹ãªã€‚

dist/index.html ã‚’æ¬¡ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã—ãŸã€‚

```html
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Getting Started</title>
  </head>
  <body>
    <script src="main.js"></script>
  </body>
</html>
```

Lodash ã‚’èª­ã¿è¾¼ã‚€ `<script>` ãŒæ¶ˆãˆã¦ã€ main.js ã‚’èª­ã¿è¾¼ã‚€ã ã‘ã«ãªã‚Šã¾ã—ãŸã€‚

ãƒãƒ³ãƒ‰ãƒ«ã—ã¾ã™ã€‚

```
$ npx webpack
Hash: 5c528a4f6539a8a8f045
Version: webpack 4.5.0
Time: 7292ms
Built at: 2018-4-6 14:19:48
  Asset    Size  Chunks             Chunk Names
main.js  70 KiB       0  [emitted]  main
Entrypoint main = main.js
   [1] (webpack)/buildin/module.js 519 bytes {0} [built]
   [2] (webpack)/buildin/global.js 509 bytes {0} [built]
   [3] ./src/index.js 263 bytes {0} [built]
    + 1 hidden module

WARNING in configuration
The 'mode' option has not been set, webpack will fallback to 'production' for this value. Set 'mode' option to 'development' or 'production' to enable defaults for each environment.
You can also set it to 'none' to disable any default behavior. Learn more: https://webpack.js.org/concepts/mode/
```

é…ã‹ã£ãŸã€ã‹ã¤ã€è­¦å‘ŠãŒå‡ºã¦ã„ã¾ã™ãŒã€ãƒãƒ³ãƒ‰ãƒ«ã§ããŸã‚ˆã†ã§ã™ã€‚

dist/main.js ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã—ãŸã€‚
webpack ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã§ã¯ã€ dist ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã® main.js ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã®ã‹ãªã€‚

dist/index.html ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã§é–‹ãã¾ã™ã€‚

ã™ã‚‹ã¨ã€ Hello webpack ã¨è¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚

æœ€åˆã€ dist/index.html ã« `<meta charset="utf-8">` ã‚’è¨˜è¿°ã—ãªã‹ã£ãŸã‚‰ä½•ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚
Microsoft Edge ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¨ãƒ©ãƒ¼ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚
Firefox ã¯æ¬¡ã®ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚

```
SyntaxError: unterminated character class
HTML ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå®£è¨€ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã« US ASCII å¤–ã®æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®è¨­å®šã«ã‚ˆã£ã¦ã¯æ–‡å­—åŒ–ã‘ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãƒšãƒ¼ã‚¸ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸­ã¾ãŸã¯è»¢é€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§å®£è¨€ã•ã‚Œãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚
```

Lodash ãŒæ‚ªã„ã®ã‹ãªã€‚
`<script>` ã§èª­ã¿è¾¼ã‚“ã§ã„ãŸãƒ•ã‚¡ã‚¤ãƒ« (https://unpkg.com/lodash@4.16.6) ã®ä¸­ã§ã¯ `'\xe6': 'ae'` ã¨ãªã£ã¦ã„ãŸã¨ã“ã‚ãŒã€ãƒãƒ³ãƒ‰ãƒ«ã—ãŸãƒ•ã‚¡ã‚¤ãƒ« (dist/main.js) ã®ä¸­ã§ã¯ `"Ã¦":"ae"` ã¨ãªã£ã¦ã„ã¾ã—ãŸã€‚
hex ã§è¨˜è¿°ã•ã‚Œã¦ã„ãŸæ–‡å­—åˆ—ã‚‚ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹ã¨ç´”ç²‹ãªæ–‡å­—åˆ—ã«ç½®ãæ›ã‚ã£ã¦ã—ã¾ã†ã®ã‹ãªã€‚

## Using a Configuration

webpack.config.js ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ã§ã™ã€‚

project

```diff
  webpack-demo
  |- package.json
+ |- webpack.config.js
  |- /dist
    |- index.html
  |- /src
    |- index.js
```

webpack.config.js ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¬¡ã®ã‚ˆã†ã«ä½œæˆã—ã¾ã—ãŸã€‚

```javascript
const path = require('path');

module.exports = {
  entry: './src/index.js',
  output: {
    filename: 'bundle.js',
    path: path.resolve(__dirname, 'dist')
  }
};
```

webpack ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ json ã¨ã‹ã˜ã‚ƒãªãã€ js ã¿ãŸã„ã§ã™ã€‚
ã“ã‚Œã¯ã€ Gulp ã‚‚åŒã˜ã ã£ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
ã§ã‚‚ã€ config ã¨ã„ã†åå‰ã ã¨ json ã£ã¦ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚
json ã£ã½ãè¨˜è¿°ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã®ã‹ãªã€‚

[Configuration](https://webpack.js.org/configuration/) ã‚’è¦‹ã‚‹ã¨ã€ãŸãã•ã‚“è¨­å®šé …ç›®ãŒã‚ã‚‹ã‚ˆã†ã§ã—ãŸã€‚

webpack.config.js ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ã£ã¦ãƒãƒ³ãƒ‰ãƒ«ã—ã¾ã™ã€‚

```
$ npx webpack --config webpack.config.js
Hash: 112fee20be517f32d471
Version: webpack 4.5.0
Time: 7444ms
Built at: 2018-4-6 14:52:06
    Asset      Size  Chunks             Chunk Names
bundle.js  69.9 KiB       0  [emitted]  main
Entrypoint main = bundle.js
   [1] (webpack)/buildin/module.js 519 bytes {0} [built]
   [2] (webpack)/buildin/global.js 509 bytes {0} [built]
   [3] ./src/index.js 256 bytes {0} [built]
    + 1 hidden module

WARNING in configuration
The 'mode' option has not been set, webpack will fallback to 'production' for this value. Set 'mode' option to 'development' or 'production' to enable defaults for each environment.
You can also set it to 'none' to disable any default behavior. Learn more: https://webpack.js.org/concepts/mode/
```

ãƒãƒ³ãƒ‰ãƒ«ã§ããŸã‚ˆã†ã§ã™ã€‚

dist/index.html ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¬¡ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã—ãŸã€‚

```html
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Getting Started</title>
  </head>
  <body>
    <script src="bundle.js"></script>
  </body>
</html>
```

dist/index.html ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‹ã‚‰é–‹ãã¾ã™ã€‚

ã™ã‚‹ã¨ã€ Hello webpack ã¨è¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚

## çµ‚ã‚ã‚Š

[webpack](https://webpack.js.org/) ã®ãƒˆãƒƒãƒ—ã®ãƒšãƒ¼ã‚¸ã‚’è¦‹ã‚‹ã¨ã€ bundle your styles, bundle your images ã¨ã‹è¨˜è¼‰ã•ã‚Œã¦ã„ã¦ã€ã‚‚ã£ã¨ã§ããã†ã§ã—ãŸã€‚
ä»Šå›ã¯ã€ã¡ã‚‡ã£ã¨ã“ã‚Œã ã‘ã§ã¯ã‚ã¾ã‚Šãƒ¡ãƒªãƒƒãƒˆãŒæ„Ÿã˜ã‚‰ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚
